clear all
close all
clc

%-----------------------We have First,Transfer Function_Gs:
s=tf("s");
G1_1 =(-167.9*s^4 - 2667*s^3 - 2.179e04*s^2 + 2484*s - 2196)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G2_1 =(0.7199*s^9 + 22.61*s^8 + 474.4*s^7 + 742.8*s^6 + 2.684e04*s^5 + 5.515e04*s^4 + 1.342e05*s^3 + 2.439e04*s^2 - 2489*s + 7.077)/(s^10 + 27.57*s^9 + 441.6*s^8 + 3496* s^7 + 1.584e04*s^6 + 1.676e04*s^5 + 2.067e04*s^4 + 9574*s^3 + 4656*s^2 + 176.9*s + 2.031);
G3_1 =(1.447*s^7 + 39.36*s^6 + 489.5 *s^5 + 2563 *s^4 + 1540 *s^3 + 33.42 *s^2 + 175.9 *s)/(s^8 + 27.2 *s^7 + 430.8 *s^6 + 3315 *s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G4_1 =(1.447*s^6 + 39.36*s^5 + 489.5*s^4 + 2563*s^3 + 1540*s^2 + 33.42*s + 175.9)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G5_1 =(-1.447*s^6 - 22.22*s^5 - 204*s^4 - 125.8*s^3 - 47.67*s^2 - 8.349*s - 1.087e-14)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G6_1 =(-30.85*s^4 - 24.21*s^3 - 3909*s^2 - 3069*s - 1.227e04)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G7_1 =( 0.9532*s^5 - 398.3*s^4 - 344.1*s^3 - 1206*s^2 + 140.8*s + 7.19e-15)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G8_1 =(-3.52*s^9 - 95.24*s^8 - 1503*s^7 - 1.137e04*s^6 - 4.761e04*s^5 - 1.202e04*s^4 + 4528*s^3 + 1.097e05*s^2 - 1.455e04*s + 0.5825)/(s^10 + 27.57*s^9 + 441.6*s^8 + 3496*s^7 + 1.584e04*s^6 + 1.676e04*s^5 + 2.067e04*s^4 + 9574*s^3 + 4656*s^2 + 176.9*s + 2.031);
G9_1 =( 0.9532*s^4 - 398.3*s^3 - 344.1*s^2 - 1206*s + 140.8)/( s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G10_1=(-3.148*s^5 - 3.07*s^4 - 0.3632*s^3 + 75.79*s^2 - 10.82*s - 4.668e-15)/( s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);

G1_2 =(109.7*s^6 + 1803*s^5 + 2.434e04*s^4 + 1.595e05*s^3 + 1.319e06*s^2 - 1.502e05*s + 1.416e05)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G2_2 =(4565*s^8 + 2.874e04*s^7 + 4.734e05*s^6 + 3.877e05*s^5 + 4.423e05*s^4 - 5.721e06*s^3 - 2.527e05*s^2 + 2.096e05*s + 105.1)/(s^10 + 27.57*s^9 + 441.6*s^8 + 3496*s^7 + 1.584e04*s^6 + 1.676e04*s^5 + 2.067e04*s^4 + 9574*s^3 + 4656*s^2 + 176.9*s + 2.031);
G3_2 =(-870.2*s^6 - 1.71e04*s^5 - 1.467e05*s^4 - 8.811e04*s^3 - 2757*s^2 - 1.134e04*s - 7.263e-13)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 87338*s^3 + 5415*s^2 + 208.2*s + 2.402);
G4_2 =(-870.2*s^5 - 1.71e04*s^4 - 1.467e05*s^3 - 8.811e04*s^2 - 2757*s - 1.134e04)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G5_2 =(-11.2*s^7 - 192.8*s^6 - 1758*s^5 - 1120*s^4 - 649.8*s^3 - 2192*s^2 + 334.7*s - 2.35)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G6_2 =(28.66*s^6 + 123.1*s^5 + 6488*s^4 + 1.943e04*s^3 + 3.686e05*s^2 + 2.737e05*s + 7.915e05)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G7_2 =(391*s^6 + 1781*s^5 + 3.736e04*s^4 + 2.823e04*s^3 + 7.692e04*s^2 - 9083*s + 5.285e-12)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G8_2 =(836.3*s^7 + 1.036e04*s^6 + 1.055e05*s^5 - 6.232e04*s^4 - 7.052e05*s^3 - 6.135e06*s^2 + 9.727e05*s + 361.2)/(s^10 + 27.57*s^9 + 441.6*s^8 + 3496*s^7 + 1.584e04*s^6 + 1.676e04*s^5 + 2.067e04*s^4 + 9574*s^3 + 4656*s^2 + 176.9*s + 2.031);
G9_2 =(391*s^5 + 1781*s^4 + 3.736e04*s^3 + 2.823e04*s^2 + 7.692e04*s - 9083)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G10_2=(2.924*s^7 + 12.23*s^6 + 269.7*s^5 + 127.2*s^4 + 28.74*s^3 - 4532*s^2 + 709.4*s + 0.1302)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);

G1_3 =(2697*s^3 + 2.413e04*s^2 + 1.966e05*s + 5.75e-12)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G2_3 =(5.996*s^8 + 163.1*s^7 + 2.462e04*s^6 + 3.456e05*s^5 + 2.469e06*s^4 + 2.191e06*s^3 + 3.956e05*s^2 + 2174*s + 14.47)/(s^10 + 27.57*s^9 + 441.6*s^8 + 3496*s^7 + 1.584e04*s^6 + 1.676e04*s^5 + 2.067e04*s^4 + 9574*s^3 + 4656*s^2 + 176.9*s + 2.031);
G3_3 =(-13*s^6 - 355*s^5 - 3475*s^4 - 2.258e04*s^3 - 1.575e04*s^2 - 6.717e-13*s - 6.104e-15)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G4_3 =(-13*s^5 - 355*s^4 - 3475*s^3 - 2.258e04*s^2 - 1.575e04*s + 7.43e-12)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G5_3 =(13*s^5 + 79.79*s^4 + 796.5*s^3 + 582.4*s^2 - 1.882*s - 8.711e-16)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G6_3 =(204.3*s^7 + 5580*s^6 + 8.864e04*s^5 + 6.871e05*s^4 + 2.988e06*s^3 + 2.087e06*s^2 + 1.104e06*s)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G7_3 =(-17.05*s^6 - 465.6*s^5 - 5168*s^4 - 2.544e04*s^3 - 1.701e04*s^2 - 50.08*s - 6.182e-32)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G8_3 =(-7.516*s^9 - 204.9*s^8 - 3082*s^7 - 2.048e04*s^6 - 3.416e04*s^5 + 5.177e05*s^4 + 2.55e06*s^3 + 1.704e06*s^2 + 4457*s - 0.9429)/(s^10 + 27.57*s^9 + 441.6*s^8 + 3496*s^7 + 1.584e04*s^6 + 1.676e04*s^5 + 2.067e04*s^4 + 9574*s^3 + 4656*s^2 + 176.9*s + 2.031);
G9_3 =(-17.05*s^5 - 465.6*s^4 - 5168*s^3 - 2.544e04*s^2 - 1.701e04*s - 50.08)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G10_3=(17.05*s^5 + 243.5*s^4 + 1765*s^3 + 1244*s^2 + 3.131*s - 8.477e-17)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);

G1_4 =(-42.65*s^6 + 195.3*s^5 - 9561*s^4 - 6.337e04*s^3 - 5.107e05*s^2 + 5.836e04*s + 6.616e04)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G2_4 =(1.55e04*s^8 + 2.153e05*s^7 + 1.674e06*s^6 + 1.649e06*s^5 + 2.277e06*s^4 + 4.606e06*s^3 + 1.947e06*s^2 + 1.635e05*s + 770.7)/(s^10 + 27.57*s^9 + 441.6*s^8 + 3496*s^7 + 1.584e04*s^6 + 1.676e04*s^5 + 2.067e04*s^4 + 9574*s^3 + 4656*s^2 + 176.9*s + 2.031);
G3_4 =(1064*s^6 + 7269*s^5 + 5.726e04*s^4 + 3.367e04*s^3 - 1.166e04*s^2 - 5300*s + 2.089e-13)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G4_4 =(1064*s^5 + 7269*s^4 + 5.726e04*s^3 + 3.367e04*s^2 - 1.166e04*s - 5300)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G5_4 =(4.352*s^7 - 16.51*s^6 - 104.4*s^5 - 36.9*s^4 - 71.88*s^3 + 1286*s^2 + 228.9*s - 0.2466)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G6_4 =(114.8*s^6 + 1542*s^5 + 2.681e04*s^4 + 2.108e05*s^3 + 1.552e06*s^2 + 1.096e06*s + 3.726e05)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G7_4 =(1534*s^6 + 2.045e04*s^5 + 1.554e05*s^4 + 9.129e04*s^3 + 2.495e04*s^2 - 4278*s + 1.026e-12)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G8_4 =(786.6*s^7 + 1.366e04*s^6 + 9.504e04*s^5 + 3.232e04*s^4 + 4.601e05*s^3 + 3.812e06*s^2 + 6.723e05*s + 2648)/(s^10 + 27.57*s^9 + 441.6*s^8 + 3496*s^7 + 1.584e04*s^6 + 1.676e04*s^5 + 2.067e04*s^4 + 9574*s^3 + 4656*s^2 + 176.9*s + 2.031);
G9_4 =(1534*s^5 + 2.045e04*s^4 + 1.554e05*s^3 + 9.129e04*s^2 + 2.495e04*s - 4278)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);
G10_4=(11.71*s^7 + 156*s^6 + 1184*s^5 + 746.7*s^4 + 549.1*s^3 + 2776*s^2 + 491.1*s + 1.879)/(s^8 + 27.2*s^7 + 430.8*s^6 + 3315*s^5 + 1.426e04*s^4 + 8733*s^3 + 5415*s^2 + 208.2*s + 2.402);

Gs=[G1_1 G1_2 G1_3 G1_4;
    G2_1 G2_2 G2_3 G2_4;
    G3_1 G3_2 G3_3 G3_4;
    G4_1 G4_2 G4_3 G4_4;
    G5_1 G5_2 G5_3 G5_4;
    G6_1 G6_2 G6_3 G6_4;
    G7_1 G7_2 G7_3 G7_4;
    G8_1 G8_2 G8_3 G8_4;
    G9_1 G9_2 G9_3 G9_4;
    G10_1 G10_2 G10_3 G10_4];


syms k
[r,c]=size(Gs);
Ks=eye(c);
I=eye(r,c);
M11=I;
M12=- Gs;
M21=I;
M22=- Gs;
M=[M11 M12;M21 M22]
w_fv=logspace(-2,3,500);
size(M)
size(w_fv)
sv=sigma(M,w_fv);
sv_max=ones(1,size(sv,2));
for i=1:size(sv,2)
    temp=max(sv(1,i),sv(2,i));
    sv_max(i)=max(temp,sv(3,i));
end
loglog(w_fv,sv_max); 
hold on;
grid on;
xlabel('\omega [rad/s]');
legend('maximum singular value of M');
